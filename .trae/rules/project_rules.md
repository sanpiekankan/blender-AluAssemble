以下是基于Blender的铝型材搭建插件（暂定名**AluFrame**）的完整产品需求文档，涵盖产品定位、核心功能、用户体验、技术约束等维度，确保需求可落地、可验证。


### **一、产品定位与价值**  
**产品名称**：AluFrame（Blender铝型材搭建插件）  
**定位**：一款基于Blender的轻量化插件，专注于铝型材及配件的参数化设计、智能组装与工程化BOM输出，帮助中小制造企业、工程师快速完成机架、工作台、防护栏等中小规模铝型材结构的设计。  
**核心价值**：  
- 复用Blender成熟3D引擎，降低开发成本，同时满足工程级精度需求（±0.1mm）；  
- 简化专业CAD的操作复杂度，让非专业用户也能快速上手；  
- 打通“设计→BOM→生产”链路，输出可直接用于采购、切割的工程化数据。  


### **二、目标用户与核心痛点**  
| 目标用户         | 核心需求场景                          | 痛点                                  | 插件解决方式                          |  
|------------------|---------------------------------------|---------------------------------------|---------------------------------------|  
| 中小制造企业     | 快速设计工作台、货架等简易结构        | 专业CAD太贵/难学，手绘图纸不精准      | 轻量化插件+极简界面，30分钟上手        |  
| 设备集成商       | 定制化机架设计（需精准连接与承重）    | 型材与配件匹配易出错，BOM统计繁琐     | 智能吸附+配件推荐+自动BOM             |  
| 职业院校/培训机构 | 铝型材结构教学（展示连接原理）        | 传统教具不直观，3D模型难快速修改      | 参数化实时修改+3D可视化，支持动态演示  |  


### **三、核心功能需求（分版本）**  

#### **（一）MVP版本：核心闭环功能**  
聚焦“型材添加→参数修改→简单组装→BOM输出”基础链路，确保可用、有用。  

1. **型材库管理**  
   - **基础库覆盖**：内置国标（GB/T 6892）、欧标（EN 12020-2）常用系列：  
     - 国标：20×20、30×30、40×40、40×80（方管）；20×40、30×60（矩形管）（共6种核心型号）；  
     - 欧标：20×20、30×30、40×40、45×45（共4种核心型号）。  
   - **库结构与交互**：  
     - 左侧面板按“标准（国标/欧标）→系列（20/30/40）”树形分类，支持型号搜索（如输入“4040”快速定位）；  
     - 型材预览：选中型材后显示2D截面图（含槽宽、壁厚标注）和3D缩略图；  
     - 添加方式：支持“点击添加”（默认生成1000mm长型材，居中放置）和“拖拽添加”（拖拽到3D视图指定位置）。  
   - **数据属性**：每个型材模型绑定自定义属性（`alu_type`：型号；`standard`：国标/欧标；`length`：长度；`material`：铝合金）。  


2. **参数化建模**  
   - **核心参数**：支持修改“长度”（范围：50mm~3000mm，精度±0.1mm）；  
   - **修改方式**：  
     - 快捷修改：选中型材后，拖拽两端端点（带动态长度数值提示，如“1200mm”）；  
     - 精确修改：右侧参数面板输入数值（支持整数/小数，如“850.5”），回车实时更新模型；  
   - **几何生成**：基于Blender几何节点（Geometry Nodes）实现：  
     - 截面：自动生成带槽口的标准截面（如40×40型材的4个对称槽口，槽宽8mm）；  
     - 长度：通过“拉伸”节点关联`length`属性，修改时模型实时伸缩，不改变截面精度。  


3. **基础智能组装**  
   - **吸附规则**（针对核心连接场景）：  
     - 90°角接：当型材A的端部（距离≤5mm）靠近型材B的侧面时，自动对齐A的端部中心与B的槽口中心（X/Y轴正交），显示绿色对齐辅助线；  
     - 同轴线对接：同系列型材的端面（距离≤3mm）靠近时，自动对齐轴线（共线），显示蓝色辅助线；  
   - **交互约束**：吸附生效后，型材可沿吸附轴微调（如角接后可沿B的长度方向滑动），但保持垂直/共线关系；  
   - **简易碰撞提示**：当两个型材重叠面积＞30%（基于边界盒检测），底部状态栏显示红色提示“模型干涉，请调整”。  


4. **实时BOM生成与导出**  
   - **BOM清单维度**：  
     - 基础信息：型材型号、执行标准（国标/欧标）、单根长度（mm）、数量（根）、总长度（mm）；  
     - 交互：点击BOM条目，3D视图中对应型材高亮闪烁（双向联动）。  
   - **实时性**：添加/删除型材、修改长度时，BOM自动更新（延迟≤0.5秒）。  
   - **导出功能**：支持导出为Excel（.xlsx），包含表头“铝型材BOM清单”、导出时间、统计总览（总根数、总长度）。  


5. **Blender界面简化**  
   - **定制工作台**：新增“AluFrame工作台”，切换后自动隐藏Blender原生的“雕刻”“动画”“视频编辑”等无关工作区；  
   - **核心工具栏**：顶部仅保留5个按钮：“新建型材”“删除选中”“撤销”“重做”“导出BOM”；  
   - **面板布局**：  
     - 左侧：型材库面板（可折叠，占宽20%）；  
     - 中间：3D视图（占比60%，保留Blender基础操作：旋转/缩放/平移）；  
     - 右侧：参数面板（选中型材时显示长度修改框，未选中时显示BOM清单，占宽20%）。  


#### **（二）1.0版本：功能增强（基于MVP反馈）**  
补充配件库、扩展组装能力、提升工程化细节。  

1. **配件库集成**  
   - 基础配件：角码（90°角码、135°角码，适配20/30/40系列）、T型连接器、M5/M6螺栓（含螺母）；  
   - 交互：配件库与型材库共用左侧面板（新增“配件”分类），拖拽配件到型材连接位置时，自动吸附到槽口（如角码贴合型材侧面）；  
   - BOM关联：配件计入BOM，新增“配件型号”“规格”“数量”列（如“30系列90°角码，数量4个”）。  


2. **智能组装扩展**  
   - 新增吸附规则：T型连接（横向型材槽口靠近纵向型材槽口时，自动居中吸附）、十字交叉连接（垂直交叉时对齐中心）；  
   - 吸附精度调节：右侧面板新增“吸附灵敏度”滑块（1-5级，对应吸附触发距离2-10mm）；  
   - 碰撞检测优化：基于Blender物理引擎（Bullet），显示干涉区域的红色半透明高亮（而非仅提示文字）。  


3. **BOM深化**  
   - 新增数据维度：型材理论重量（kg，基于密度2.7g/cm³+体积计算）、配件材质（铝合金/钢）；  
   - 导出扩展：支持PDF导出（含3D场景截图+BOM表格，便于发给供应商）。  


4. **用户体验优化**  
   - 快捷键：W（平移型材）、E（旋转型材，仅限未吸附状态）、R（修改长度）、Delete（删除选中）；  
   - 新手引导：首次使用弹出“3步引导”（配动图）：①添加型材 ②修改长度 ③角接组装。  


#### **（三）2.0版本：高级功能（面向专业场景）**  
1. 自定义型材：支持用户上传截面参数（JSON格式），生成非标准型材；  
2. 切割优化：自动计算同型号型材的最优原料切割方案（减少废料）；  
3. 场景模板：内置“工作台”“防护栏”“小型机架”等模板，一键加载基础结构；  
4. 云同步：关联云端账号，保存/加载项目（需适配Blender云服务）。  


### **四、非功能需求**  
1. **兼容性**：支持Blender 3.6（LTS）、4.0、4.1版本（覆盖90%以上用户）；  
2. **性能**：  
   - 30根型材+20个配件的场景：旋转/缩放视图帧率≥25FPS；  
   - BOM生成耗时≤1秒（50根型材以内）；  
3. **易用性**：新用户完成首个简单结构设计（如10根型材组成的框架）的学习时间≤30分钟；  
4. **可扩展性**：型材库/配件库支持用户手动添加（通过JSON文件导入）；  
5. **稳定性**：连续操作1小时（添加/修改/组装）无崩溃，模型数据不丢失。  


### **五、用户体验设计（UX）**  
1. **核心流程**：  
   「打开Blender→切换到AluFrame工作台→左侧选择型材→添加到画布→右侧修改长度→拖拽型材靠近触发吸附→完成组装→右侧导出BOM」  
2. **反馈机制**：  
   - 吸附成功：绿色辅助线闪烁+轻微“咔哒”音效（可在设置中关闭）；  
   - 参数错误（如长度＜50mm）：输入框变红+弹窗提示“长度需≥50mm”；  
   - 操作成功：导出BOM后显示“导出成功，保存路径：XXX”。  
3. **帮助系统**：  
   - 面板右上角“？”按钮：展开上下文帮助（如选中型材时显示“如何修改长度”）；  
   - 插件设置页提供“使用手册”链接（含图文教程+视频）。  


### **六、数据与集成需求**  
1. **数据存储**：  
   - 型材/配件参数：本地JSON文件（路径：Blender插件目录下的`assets`文件夹），支持用户手动编辑扩展；  
   - 项目数据：随Blender原生`.blend`文件保存（型材属性、BOM数据嵌入场景）。  
2. **外部集成**：  
   - 导出格式：Excel（.xlsx，依赖`openpyxl`库）、PDF（依赖`reportlab`库）；  
   - 未来扩展：支持导出为DXF格式（用于切割设备）、对接企业ERP系统（需API开发）。  


### **七、约束与限制**  
1. **技术约束**：遵循Blender GPL协议，插件开源，二次开发需保留原版权信息；  
2. **功能边界**：不支持曲面型材、复杂异形截面（聚焦标准矩形/方形铝型材）；  
3. **性能限制**：建议单个场景型材数量≤100根（超过后需手动开启“简化显示模式”）。  


### **八、验收标准（MVP版本）**  
1. 型材库：可正常添加10种核心型号，截面符合国标/欧标尺寸（误差≤0.1mm）；  
2. 参数化：修改长度后，模型实时更新，BOM同步变化，精度达标；  
3. 组装：90°角接、同轴线对接的吸附成功率≥95%（100次测试中失败≤5次）；  
4. BOM：导出Excel包含所有必填字段，数据与场景一致（无遗漏/错误）；  
5. 稳定性：连续操作30分钟（含100次添加/修改/删除）无崩溃。  


此需求文档明确了插件的核心边界与落地标准，兼顾工程化精度与用户易用性，可作为开发、测试、验收的基准。